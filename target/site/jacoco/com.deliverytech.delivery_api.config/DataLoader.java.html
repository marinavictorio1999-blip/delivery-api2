<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pt"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DataLoader.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">delivery-api</a> &gt; <a href="index.source.html" class="el_package">com.deliverytech.delivery_api.config</a> &gt; <span class="el_source">DataLoader.java</span></div><h1>DataLoader.java</h1><pre class="source lang-java linenums">package com.deliverytech.delivery_api.config;
 
import com.deliverytech.delivery_api.model.*;
import com.deliverytech.delivery_api.repository.*;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;
import java.math.BigDecimal;
 
import java.util.Arrays;
import java.util.List;
 
 
@Component
<span class="fc" id="L15">public class DataLoader implements CommandLineRunner {</span>
 
    @Autowired
    private ClienteRepository clienteRepository;
 
    @Autowired
    private RestauranteRepository restauranteRepository;
 
    @Autowired
    private ProdutoRepository produtoRepository;
 
    @Autowired
    private PedidoRepository pedidoRepository;
 
    @Override
    public void run(String... args) throws Exception {
<span class="fc" id="L31">        System.out.println(&quot;=== INICIANDO CARGA DE DADOS DE TESTE ===&quot;);</span>
 
     
        // Inserir dados de teste (sem limpar dados existentes)
<span class="fc" id="L35">        inserirClientes();</span>
<span class="fc" id="L36">        inserirRestaurantes();</span>
 
<span class="fc" id="L38">        System.out.println(&quot;=== CARGA DE DADOS CONCLU√çDA ===&quot;);</span>
       
        // ‚úÖ ADICIONAR: Spring Boot iniciada com sucesso + Bender
<span class="fc" id="L41">        System.out.println(&quot;\n‚úÖ Spring Boot Application iniciada com sucesso!&quot;);</span>
       
       
        // ‚úÖ INFORMAR sobre captura autom√°tica
<span class="fc" id="L45">        System.out.println(&quot;\nüéØ SISTEMA DE CAPTURA AUTOM√ÅTICA ATIVO!&quot;);</span>
<span class="fc" id="L46">        System.out.println(&quot;üìÅ Respostas ser√£o salvas em: ./entregaveis/&quot;);</span>
<span class="fc" id="L47">        System.out.println(&quot;üîÑ Fa√ßa requisi√ß√µes para /api/* e veja os arquivos sendo gerados!\n&quot;);</span>
<span class="fc" id="L48">    }</span>
 
 
private void inserirClientes() {
<span class="fc" id="L52">    System.out.println(&quot;--- Inserindo clientes ---&quot;);</span>
 
<span class="fc" id="L54">    Cliente cliente1 = new Cliente(null, &quot;Jo√£o Silva&quot;, &quot;joao@email.com&quot;,</span>
            &quot;11987654321&quot;, &quot;Rua das Flores, 123 - Vila Madalena, S√£o Paulo - SP&quot;,
<span class="fc" id="L56">            null, true, null);</span>
 
<span class="fc" id="L58">    Cliente cliente2 = new Cliente(null, &quot;Maria Santos&quot;, &quot;maria@email.com&quot;,</span>
            &quot;11876543210&quot;, &quot;Av. Paulista, 456 - Bela Vista, S√£o Paulo - SP&quot;,
<span class="fc" id="L60">            null, true, null);</span>
 
<span class="fc" id="L62">    Cliente cliente3 = new Cliente(null, &quot;Pedro Oliveira&quot;, &quot;pedro@email.com&quot;,</span>
            &quot;11765432109&quot;, &quot;Rua Augusta, 789 - Consola√ß√£o, S√£o Paulo - SP&quot;,
<span class="fc" id="L64">            null, false, null);</span>
 
<span class="fc" id="L66">    Cliente cliente4 = new Cliente(null, &quot;Ana Costa&quot;, &quot;ana@email.com&quot;,</span>
            &quot;11654321098&quot;, &quot;Rua Oscar Freire, 321 - Jardins, S√£o Paulo - SP&quot;,
<span class="fc" id="L68">            null, true, null);</span>
 
<span class="fc" id="L70">    Cliente cliente5 = new Cliente(null, &quot;Carlos Ferreira&quot;, &quot;carlos@email.com&quot;,</span>
            &quot;11543210987&quot;, &quot;Rua 25 de Mar√ßo, 654 - Centro, S√£o Paulo - SP&quot;,
<span class="fc" id="L72">            null, true, null);</span>
 
<span class="fc" id="L74">    List&lt;Cliente&gt; clientes = Arrays.asList(cliente1, cliente2, cliente3, cliente4, cliente5);</span>
 
<span class="fc bfc" id="L76" title="All 2 branches covered.">    for (Cliente cliente : clientes) {</span>
<span class="pc bpc" id="L77" title="1 of 2 branches missed.">        if (clienteRepository.findByEmail(cliente.getEmail()).isEmpty()) {</span>
<span class="fc" id="L78">            clienteRepository.save(cliente);</span>
<span class="fc" id="L79">            System.out.println(&quot;‚úì Cliente &quot; + cliente.getNome() + &quot; inserido&quot;);</span>
        } else {
<span class="nc" id="L81">            System.out.println(&quot;‚ö† Cliente &quot; + cliente.getNome() + &quot; j√° existe, ignorando...&quot;);</span>
        }
<span class="fc" id="L83">    }</span>
<span class="fc" id="L84">}</span>
 
private void inserirRestaurantes() {
<span class="fc" id="L87">    System.out.println(&quot;--- Inserindo Restaurantes ---&quot;);</span>
 
<span class="fc" id="L89">    Restaurante restaurante1 = Restaurante.builder()</span>
<span class="fc" id="L90">            .nome(&quot;Pizza Express&quot;)</span>
<span class="fc" id="L91">            .categoria(&quot;Italiana&quot;)</span>
<span class="fc" id="L92">            .telefone(&quot;1133333333&quot;)</span>
<span class="fc" id="L93">            .TaxaEntrega(new BigDecimal(&quot;3.50&quot;))</span>
<span class="fc" id="L94">            .ativo(true)</span>
<span class="fc" id="L95">            .build();</span>
 
<span class="fc" id="L97">    Restaurante restaurante2 = Restaurante.builder()</span>
<span class="fc" id="L98">            .nome(&quot;Burger King&quot;)</span>
<span class="fc" id="L99">            .categoria(&quot;Fast Food&quot;)</span>
<span class="fc" id="L100">            .telefone(&quot;1144444444&quot;)</span>
<span class="fc" id="L101">            .TaxaEntrega(new BigDecimal(&quot;5.00&quot;))</span>
<span class="fc" id="L102">            .ativo(true)</span>
<span class="fc" id="L103">            .build();</span>
 
<span class="fc" id="L105">    List&lt;Restaurante&gt; restaurantes = Arrays.asList(restaurante1, restaurante2);</span>
 
    // Salvar restaurantes se n√£o existirem
<span class="fc bfc" id="L108" title="All 2 branches covered.">    for (Restaurante restaurante : restaurantes) {</span>
<span class="pc bpc" id="L109" title="1 of 2 branches missed.">        if (restauranteRepository.findByNome(restaurante.getNome()).isEmpty()) {</span>
<span class="fc" id="L110">            restauranteRepository.save(restaurante);</span>
<span class="fc" id="L111">            System.out.println(&quot;‚úì Restaurante &quot; + restaurante.getNome() + &quot; inserido&quot;);</span>
        } else {
<span class="nc" id="L113">            System.out.println(&quot;‚ö† Restaurante &quot; + restaurante.getNome() + &quot; j√° existe, ignorando...&quot;);</span>
        }
<span class="fc" id="L115">    }</span>
 
    // Agora sim, chamar inserirProdutos()
   
<span class="fc" id="L119">}</span>
 
 
 
 
private void inserirProdutos() {
<span class="nc" id="L125">    System.out.println(&quot;--- Inserindo Produtos ---&quot;);</span>
 
<span class="nc" id="L127">    var restaurantes = restauranteRepository.findAll();</span>
 
<span class="nc" id="L129">    var pizzaExpress = restaurantes.stream()</span>
<span class="nc" id="L130">            .filter(r -&gt; r.getNome().equals(&quot;Pizza Express&quot;))</span>
<span class="nc" id="L131">            .findFirst().orElse(null);</span>
 
<span class="nc" id="L133">    var burgerKing = restaurantes.stream()</span>
<span class="nc" id="L134">            .filter(r -&gt; r.getNome().equals(&quot;Burger King&quot;))</span>
<span class="nc" id="L135">            .findFirst().orElse(null);</span>
 
<span class="nc" id="L137">    var sushiHouse = restaurantes.stream()</span>
<span class="nc" id="L138">            .filter(r -&gt; r.getNome().equals(&quot;Sushi House&quot;))</span>
<span class="nc" id="L139">            .findFirst().orElse(null);</span>
 
<span class="nc" id="L141">    var gyrosAthenas = restaurantes.stream()</span>
<span class="nc" id="L142">            .filter(r -&gt; r.getNome().equals(&quot;Gyros Athenas&quot;))</span>
<span class="nc" id="L143">            .findFirst().orElse(null);</span>
 
<span class="nc" id="L145">    var chipariaPorto = restaurantes.stream()</span>
<span class="nc" id="L146">            .filter(r -&gt; r.getNome().equals(&quot;Chiparia do Porto&quot;))</span>
<span class="nc" id="L147">            .findFirst().orElse(null);</span>
 
    // Criando produtos
<span class="nc" id="L150">    List&lt;Produto&gt; produtos = Arrays.asList(</span>
<span class="nc" id="L151">        Produto.builder()</span>
<span class="nc" id="L152">            .nome(&quot;Pizza Margherita&quot;)</span>
<span class="nc" id="L153">            .categoria(&quot;Pizza&quot;)</span>
<span class="nc" id="L154">            .descricao(&quot;Pizza cl√°ssica com molho de tomate, mussarela e manjeric√£o&quot;)</span>
<span class="nc" id="L155">            .preco(new BigDecimal(&quot;25.90&quot;))</span>
<span class="nc" id="L156">            .restaurante(pizzaExpress)</span>
<span class="nc" id="L157">            .ativo(true)</span>
<span class="nc" id="L158">            .build(),</span>
 
<span class="nc" id="L160">        Produto.builder()</span>
<span class="nc" id="L161">            .nome(&quot;Pizza Pepperoni&quot;)</span>
<span class="nc" id="L162">            .categoria(&quot;Pizza&quot;)</span>
<span class="nc" id="L163">            .descricao(&quot;Pizza com molho de tomate, mussarela e pepperoni&quot;)</span>
<span class="nc" id="L164">            .preco(new BigDecimal(&quot;29.90&quot;))</span>
<span class="nc" id="L165">            .restaurante(pizzaExpress)</span>
<span class="nc" id="L166">            .ativo(true)</span>
<span class="nc" id="L167">            .build(),</span>
 
<span class="nc" id="L169">        Produto.builder()</span>
<span class="nc" id="L170">            .nome(&quot;Big Burger&quot;)</span>
<span class="nc" id="L171">            .categoria(&quot;Hamb√∫rguer&quot;)</span>
<span class="nc" id="L172">            .descricao(&quot;Hamb√∫rguer duplo com queijo, alface, tomate e molho especial&quot;)</span>
<span class="nc" id="L173">            .preco(new BigDecimal(&quot;18.50&quot;))</span>
<span class="nc" id="L174">            .restaurante(burgerKing)</span>
<span class="nc" id="L175">            .ativo(true)</span>
<span class="nc" id="L176">            .build(),</span>
 
<span class="nc" id="L178">        Produto.builder()</span>
<span class="nc" id="L179">            .nome(&quot;Batata Frita Grande&quot;)</span>
<span class="nc" id="L180">            .categoria(&quot;Acompanhamento&quot;)</span>
<span class="nc" id="L181">            .descricao(&quot;Por√ß√£o grande de batatas fritas crocantes&quot;)</span>
<span class="nc" id="L182">            .preco(new BigDecimal(&quot;8.90&quot;))</span>
<span class="nc" id="L183">            .restaurante(burgerKing)</span>
<span class="nc" id="L184">            .ativo(true)</span>
<span class="nc" id="L185">            .build(),</span>
 
<span class="nc" id="L187">        Produto.builder()</span>
<span class="nc" id="L188">            .nome(&quot;Sushi Salm√£o&quot;)</span>
<span class="nc" id="L189">            .categoria(&quot;Sushi&quot;)</span>
<span class="nc" id="L190">            .descricao(&quot;8 pe√ßas de sushi de salm√£o fresco&quot;)</span>
<span class="nc" id="L191">            .preco(new BigDecimal(&quot;32.00&quot;))</span>
<span class="nc" id="L192">            .restaurante(sushiHouse)</span>
<span class="nc" id="L193">            .ativo(true)</span>
<span class="nc" id="L194">            .build(),</span>
 
<span class="nc" id="L196">        Produto.builder()</span>
<span class="nc" id="L197">            .nome(&quot;Hot Roll&quot;)</span>
<span class="nc" id="L198">            .categoria(&quot;Sushi&quot;)</span>
<span class="nc" id="L199">            .descricao(&quot;8 pe√ßas de hot roll empanado com salm√£o&quot;)</span>
<span class="nc" id="L200">            .preco(new BigDecimal(&quot;28.50&quot;))</span>
<span class="nc" id="L201">            .restaurante(sushiHouse)</span>
<span class="nc" id="L202">            .ativo(true)</span>
<span class="nc" id="L203">            .build(),</span>
 
<span class="nc" id="L205">        Produto.builder()</span>
<span class="nc" id="L206">            .nome(&quot;Gyros de Cordeiro&quot;)</span>
<span class="nc" id="L207">            .categoria(&quot;Espeto&quot;)</span>
<span class="nc" id="L208">            .descricao(&quot;Espeto de cordeiro grelhado com molho tzatziki, tomate e cebola roxa&quot;)</span>
<span class="nc" id="L209">            .preco(new BigDecimal(&quot;35.90&quot;))</span>
<span class="nc" id="L210">            .restaurante(gyrosAthenas)</span>
<span class="nc" id="L211">            .ativo(true)</span>
<span class="nc" id="L212">            .build(),</span>
 
<span class="nc" id="L214">        Produto.builder()</span>
<span class="nc" id="L215">            .nome(&quot;Souvlaki de Frango&quot;)</span>
<span class="nc" id="L216">            .categoria(&quot;Espeto&quot;)</span>
<span class="nc" id="L217">            .descricao(&quot;Espetinho de frango marinado com ervas gregas e batata frita&quot;)</span>
<span class="nc" id="L218">            .preco(new BigDecimal(&quot;28.50&quot;))</span>
<span class="nc" id="L219">            .restaurante(gyrosAthenas)</span>
<span class="nc" id="L220">            .ativo(true)</span>
<span class="nc" id="L221">            .build(),</span>
 
<span class="nc" id="L223">        Produto.builder()</span>
<span class="nc" id="L224">            .nome(&quot;Fish &amp; Chips Tradicional&quot;)</span>
<span class="nc" id="L225">            .categoria(&quot;Peixe&quot;)</span>
<span class="nc" id="L226">            .descricao(&quot;Fil√© de bacalhau empanado com batatas fritas e molho t√°rtaro&quot;)</span>
<span class="nc" id="L227">            .preco(new BigDecimal(&quot;42.90&quot;))</span>
<span class="nc" id="L228">            .restaurante(chipariaPorto)</span>
<span class="nc" id="L229">            .ativo(true)</span>
<span class="nc" id="L230">            .build(),</span>
 
<span class="nc" id="L232">        Produto.builder()</span>
<span class="nc" id="L233">            .nome(&quot;Por√ß√£o de Camar√£o Empanado&quot;)</span>
<span class="nc" id="L234">            .categoria(&quot;Frutos do Mar&quot;)</span>
<span class="nc" id="L235">            .descricao(&quot;500g de camar√£o empanado com molho agridoce&quot;)</span>
<span class="nc" id="L236">            .preco(new BigDecimal(&quot;52.00&quot;))</span>
<span class="nc" id="L237">            .restaurante(chipariaPorto)</span>
<span class="nc" id="L238">            .ativo(true)</span>
<span class="nc" id="L239">            .build()</span>
    );
 
    // Salvar todos os produtos
<span class="nc bnc" id="L243" title="All 2 branches missed.">   for (Produto produto : produtos) {</span>
    // Verifica se j√° existe produto com mesmo nome no mesmo restaurante
<span class="nc" id="L245">    var existente = produtoRepository.findByNomeAndRestaurante_Id(produto.getNome(), produto.getRestaurante().getId());</span>
 
<span class="nc bnc" id="L247" title="All 2 branches missed.">    if (existente.isEmpty()) {</span>
<span class="nc" id="L248">        produtoRepository.save(produto);</span>
<span class="nc" id="L249">        System.out.println(&quot;‚úì Produto &quot; + produto.getNome() + &quot; inserido&quot;);</span>
    } else {
<span class="nc" id="L251">        System.out.println(&quot;‚ö† Produto &quot; + produto.getNome() + &quot; j√° existe no restaurante &quot;</span>
<span class="nc" id="L252">                           + produto.getRestaurante().getNome() + &quot;, ignorando...&quot;);</span>
    }
<span class="nc" id="L254">}</span>
 
<span class="nc" id="L256">}</span>
 
 
 
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>